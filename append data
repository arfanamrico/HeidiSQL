drop table if exists `TMP`;
CREATE TABLE `TMP` (
`DATE` VARCHAR (20) NOT NULL,
`TIME` VARCHAR (20) NOT NULL,
`Site ID` VARCHAR (10) NOT NULL,
`SID_MOCN` VARCHAR (10) NOT NULL,
`Branch` VARCHAR (20) NOT NULL,
`Kabupaten` VARCHAR (70) NOT NULL,
`Vendor` VARCHAR (10) NOT NULL,
`Band` VARCHAR (10) NOT NULL,
`MRBTS_NAME` VARCHAR (100) NOT NULL,
`LNBTS name` VARCHAR (100) NOT NULL,
`CellName` VARCHAR (150) NOT NULL,
`MRBTS_ID` INT(10) UNSIGNED NOT NULL,
`LNBTS_ID` INT(10) UNSIGNED NOT NULL,
`CELL_ID` INT(10) UNSIGNED NOT NULL,
`EARFCNDL` INT(10) UNSIGNED NOT NULL,
`DLMIMOMODE` INT(10) UNSIGNED NOT NULL,
`DLCHBW` INT(10) UNSIGNED NOT NULL,
`TAC` INT(10) UNSIGNED NOT NULL,
`OP` VARCHAR (10) NOT NULL,
`MC_H3I_Cell Availability` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Cell Availability Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Cell Availability Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Cell Availability_Auto` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Cell Availability_AuNom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Cell AvailabilityAuDen` DOUBLE NULL DEFAULT NULL,
`MC_H3I_CSSR VOLTE` DOUBLE NULL DEFAULT NULL,
`MC_H3I_CSSR VOLTE Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_CSSR VOLTE Denom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS_ERAB_Nom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS_ERAB_Denom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS_RRCNom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS_RRCDenom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS_S1_Nom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSSR PS_S1_Denom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSFB SR Nom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSFB SR Denom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_CSFB SR` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DCR VoLTE` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DCR VoLTE Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DCR VoLTE Denom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_DCR PS` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_DCR PS Nom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_DCR PS Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Intra Frequency HOSR` DOUBLE NULL DEFAULT NULL,
`MC_H3I_IntraFrequencyHOSRNom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_IntraFrequencyHOSRDenom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Inter Frequency HOSR` DOUBLE NULL DEFAULT NULL,
`MC_H3I_InterFrequencyHOSRNom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_InterFrequencyHOSRDenom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_IRAT HOSR` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_IRAT HOSR Nom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_IRAT HOSR Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_HOSR VoLTE` DOUBLE NULL DEFAULT NULL,
`MC_H3I_HOSR VoLTE Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_HOSR VoLTE Denom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_SRVCC SR VoLTE` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_SRVCC SR VoLTE Nom` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_SRVCC SR VoLTE Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Traffic Data` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Traffic Data DL` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Traffic Data UL` DOUBLE NULL DEFAULT NULL,
`MC_ISAT_Traffic VoLTE` DOUBLE NULL DEFAULT NULL,
`MC_H3I_RRC Connected User` DOUBLE NULL DEFAULT NULL,
`MC_H3I_RRC Connected User Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_RRC Connected User Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Active User` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Active User Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Active User Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_VoLTE User` DOUBLE NULL DEFAULT NULL,
`MC_H3I_CQI` DOUBLE NULL DEFAULT NULL,
`MC_H3I_CQI Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_CQI Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Spectral Eficiency` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Spectral Eficiency Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_Spectral Eficiency Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_ULRSSI` DOUBLE NULL DEFAULT NULL,
`MC_H3I_ULRSSI Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_ULRSSI Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL Cell Throughput` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL Cell Throughput Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL Cell Throughput Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL Cell Throughput` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL Cell Throughput Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL Cell Throughput Denom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_EstimateUserThroughput` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL PRB Utilization` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL PRB Utilization` DOUBLE NULL DEFAULT NULL,
`LNBTS_PARENT_BH_TRAFFIC` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL User Throughput` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL User Throughput Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_DL User ThroughputDenom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL User Throughput` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL User Throughput Nom` DOUBLE NULL DEFAULT NULL,
`MC_H3I_UL User ThroughputDenom` DOUBLE NULL DEFAULT NULL,
`MRBTS_BH_TRAFFIC` DOUBLE NULL DEFAULT NULL,
`Last_TTI_NOM` DOUBLE NULL DEFAULT NULL,
`Last_TTI_DENOM` DOUBLE NULL DEFAULT NULL,
`QPSK_RATIO_NOM` DOUBLE NULL DEFAULT NULL,
`QPSK_RATIO_DENOM` DOUBLE NULL DEFAULT NULL,
`MIMO_RANK2_NOM` DOUBLE NULL DEFAULT NULL,
`MIMO_RANK2_DENOM` DOUBLE NULL DEFAULT NULL,
`MIMO_RANK4_NOM` DOUBLE NULL DEFAULT NULL,
`MIMO_RANK4_DENOM` DOUBLE NULL DEFAULT NULL,
`Inter_eNB_HO_X2_NOM` DOUBLE NULL DEFAULT NULL,
`Inter_eNB_HO_X2_DENOM` DOUBLE NULL DEFAULT NULL,
`AGG1_used_PDCCH` DOUBLE NULL DEFAULT NULL,
`AGG2_used_PDCCH` DOUBLE NULL DEFAULT NULL,
`AGG4_used_PDCCH` DOUBLE NULL DEFAULT NULL,
`AGG8_used_PDCCH` DOUBLE NULL DEFAULT NULL,
`InterFreq_HO_Att` DOUBLE NULL DEFAULT NULL,
`InterFreq_LB_HO_Att` DOUBLE NULL DEFAULT NULL,
`Avg_TA_meter` DOUBLE NULL DEFAULT NULL,
`EUT_NOM` DOUBLE NULL DEFAULT NULL,
`EUT_DENOM` DOUBLE NULL DEFAULT NULL,
`BLER_NOM` DOUBLE NULL DEFAULT NULL,
`BLER_DENOM` DOUBLE NULL DEFAULT NULL,
`RTWP_RX_Ant1` DOUBLE NULL DEFAULT NULL,
`RTWP_RX_Ant2` DOUBLE NULL DEFAULT NULL,
`MC_MS_CellDLPeakThroughput` DOUBLE NULL DEFAULT NULL,
`MC_MS_CellULPeakThroughput` DOUBLE NULL DEFAULT NULL,
`complete_rach_nom` DOUBLE NULL DEFAULT NULL,
`complete_rach_denom` DOUBLE NULL DEFAULT NULL,
`PacketDelayBudget` DOUBLE NULL DEFAULT NULL,
`PRBsperTTIonPDSCH` DOUBLE NULL DEFAULT NULL,
`PRBsperTTIonPUSCH` DOUBLE NULL DEFAULT NULL,
`Intra_Enb_HO_NOM` DOUBLE NULL DEFAULT NULL,
`Intra_Enb_HO_DENOM` DOUBLE NULL DEFAULT NULL
)
COLLATE='utf8_general_ci'
ENGINE=MyISAM
ROW_FORMAT=DYNAMIC;

LOAD DATA LOCAL INFILE 'C:/Users/mWX1008015/Desktop/RawIOH 20220715-20220716.csv' INTO TABLE `TMP` FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' LINES TERMINATED BY '\n' IGNORE 1 LINES;


REPLACE into ioh_raw_4g
Select 
str_to_date(`DATE`,'%m/%d/%Y') AS date,
str_to_date(`TIME`,'%T'),
`Site ID`,
`SID_MOCN`,
`Branch`,
`Kabupaten`,
`Vendor`,
`Band`,
`MRBTS_NAME`,
`LNBTS name`,
`CellName`,
`MRBTS_ID`,
`LNBTS_ID`,
`CELL_ID`,
`EARFCNDL`,
`DLMIMOMODE`,
`DLCHBW`,
`TAC`,
`OP`,
`MC_H3I_Cell Availability`,
`MC_H3I_Cell Availability Nom`,
`MC_H3I_Cell Availability Denom`,
`MC_H3I_Cell Availability_Auto`,
`MC_H3I_Cell Availability_AuNom`,
`MC_H3I_Cell AvailabilityAuDen`,
`MC_H3I_CSSR VOLTE`,
`MC_H3I_CSSR VOLTE Nom`,
`MC_H3I_CSSR VOLTE Denom`,
`MC_ISAT_CSSR PS`,
`MC_ISAT_CSSR PS_ERAB_Nom`,
`MC_ISAT_CSSR PS_ERAB_Denom`,
`MC_ISAT_CSSR PS_RRCNom`,
`MC_ISAT_CSSR PS_RRCDenom`,
`MC_ISAT_CSSR PS_S1_Nom`,
`MC_ISAT_CSSR PS_S1_Denom`,
`MC_ISAT_CSFB SR Nom`,
`MC_ISAT_CSFB SR Denom`,
`MC_ISAT_CSFB SR`,
`MC_H3I_DCR VoLTE`,
`MC_H3I_DCR VoLTE Nom`,
`MC_H3I_DCR VoLTE Denom`,
`MC_ISAT_DCR PS`,
`MC_ISAT_DCR PS Nom`,
`MC_ISAT_DCR PS Denom`,
`MC_H3I_Intra Frequency HOSR`,
`MC_H3I_IntraFrequencyHOSRNom`,
`MC_H3I_IntraFrequencyHOSRDenom`,
`MC_H3I_Inter Frequency HOSR`,
`MC_H3I_InterFrequencyHOSRNom`,
`MC_H3I_InterFrequencyHOSRDenom`,
`MC_ISAT_IRAT HOSR`,
`MC_ISAT_IRAT HOSR Nom`,
`MC_ISAT_IRAT HOSR Denom`,
`MC_H3I_HOSR VoLTE`,
`MC_H3I_HOSR VoLTE Nom`,
`MC_H3I_HOSR VoLTE Denom`,
`MC_ISAT_SRVCC SR VoLTE`,
`MC_ISAT_SRVCC SR VoLTE Nom`,
`MC_ISAT_SRVCC SR VoLTE Denom`,
`MC_H3I_Traffic Data`,
`MC_H3I_Traffic Data DL`,
`MC_H3I_Traffic Data UL`,
`MC_ISAT_Traffic VoLTE`,
`MC_H3I_RRC Connected User`,
`MC_H3I_RRC Connected User Nom`,
`MC_H3I_RRC Connected User Denom`,
`MC_H3I_Active User`,
`MC_H3I_Active User Nom`,
`MC_H3I_Active User Denom`,
`MC_H3I_VoLTE User`,
`MC_H3I_CQI`,
`MC_H3I_CQI Nom`,
`MC_H3I_CQI Denom`,
`MC_H3I_Spectral Eficiency`,
`MC_H3I_Spectral Eficiency Nom`,
`MC_H3I_Spectral Eficiency Denom`,
`MC_H3I_ULRSSI`,
`MC_H3I_ULRSSI Nom`,
`MC_H3I_ULRSSI Denom`,
`MC_H3I_DL Cell Throughput`,
`MC_H3I_DL Cell Throughput Nom`,
`MC_H3I_DL Cell Throughput Denom`,
`MC_H3I_UL Cell Throughput`,
`MC_H3I_UL Cell Throughput Nom`,
`MC_H3I_UL Cell Throughput Denom`,
`MC_H3I_EstimateUserThroughput`,
`MC_H3I_DL PRB Utilization`,
`MC_H3I_UL PRB Utilization`,
`LNBTS_PARENT_BH_TRAFFIC`,
`MC_H3I_DL User Throughput`,
`MC_H3I_DL User Throughput Nom`,
`MC_H3I_DL User ThroughputDenom`,
`MC_H3I_UL User Throughput`,
`MC_H3I_UL User Throughput Nom`,
`MC_H3I_UL User ThroughputDenom`,
`MRBTS_BH_TRAFFIC`,
`Last_TTI_NOM`,
`Last_TTI_DENOM`,
`QPSK_RATIO_NOM`,
`QPSK_RATIO_DENOM`,
`MIMO_RANK2_NOM`,
`MIMO_RANK2_DENOM`,
`MIMO_RANK4_NOM`,
`MIMO_RANK4_DENOM`,
`Inter_eNB_HO_X2_NOM`,
`Inter_eNB_HO_X2_DENOM`,
`AGG1_used_PDCCH`,
`AGG2_used_PDCCH`,
`AGG4_used_PDCCH`,
`AGG8_used_PDCCH`,
`InterFreq_HO_Att`,
`InterFreq_LB_HO_Att`,
`Avg_TA_meter`,
`EUT_NOM`,
`EUT_DENOM`,
`BLER_NOM`,
`BLER_DENOM`,
`RTWP_RX_Ant1`,
`RTWP_RX_Ant2`,
`MC_MS_CellDLPeakThroughput`,
`MC_MS_CellULPeakThroughput`,
`complete_rach_nom`,
`complete_rach_denom`,
`PacketDelayBudget`,
`PRBsperTTIonPDSCH`,
`PRBsperTTIonPUSCH`,
`Intra_Enb_HO_NOM`,
`Intra_Enb_HO_DENOM`


from TMP;


drop table if exists `TMP`;





